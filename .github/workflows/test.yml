on:
  push:
    branches:
      - main
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: create a temporary artifact downloads folder
        run: mkdir downloads
      
      - name: list of files
        run: ls -l downloads
      
      - name: get url
        echo "URL" > "https://expo.dev/artifacts/eas/eepvn5XnaAAWKz6o3yuauU.apk"
        echo "APK=$URL" >> $GITHUB_ENV
      
      - name: add artifacts to the temp folder
        run: |
          cd downloads
          curl -sL ${{ env.APK }} > storelive-qa-456.apk
          cd ..
      
      - name: list of files
        run: ls -l downloads
      
      - name: Upload to blob storage
        if:   contains(github.event.head_commit.message , 'MAJOR')
        uses: azure/CLI@v1
        with:
          inlineScript: |
              az storage blob upload --account-name applicationapkstorage --account-key GpKA4ycifBIcHnEzBf4UGAirJbwRxhe3/11w2TeyCiVeMVUYgioR15zphM64/3yTuU/gsKQpMz9G+AStL4fvQA== --container-name apk --file downloads/storelive-qa-456.apk --name storelive-qa-456.apk
